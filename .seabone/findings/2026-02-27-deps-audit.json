[
  {
    "id": "deps-1",
    "severity": "critical",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "python-jose 3.3.0 has CVE-2024-33664 (algorithm confusion attack allowing JWT signature bypass) and CVE-2024-33663. An attacker can forge tokens by switching from asymmetric to symmetric algorithms, bypassing authentication entirely. The library is also largely unmaintained.",
    "task": "Replace python-jose with a maintained alternative (joserfc or python-jwt). If staying on python-jose, set algorithms explicitly and reject 'none' algorithm in all JWT decode calls.",
    "auto_fixable": false,
    "effort": "medium",
    "package": "python-jose",
    "current_version": "3.3.0",
    "latest_version": "3.3.0"
  },
  {
    "id": "deps-2",
    "severity": "high",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "jinja2 3.1.4 is vulnerable to CVE-2024-56201 and CVE-2024-56326 (sandbox escape via __init__.__globals__ and |attr filter abuse). Both are fixed in 3.1.5. While sandboxed mode is not always used directly, template rendering with user-controlled input could be impacted.",
    "task": "Upgrade jinja2 from 3.1.4 to >=3.1.6 (latest) in pyproject.toml.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "jinja2",
    "current_version": "3.1.4",
    "latest_version": "3.1.6"
  },
  {
    "id": "deps-3",
    "severity": "high",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "passlib 1.7.4 is the last release from 2020 and the project is effectively abandoned. As a core security library handling password hashing (pbkdf2_sha256 + bcrypt), an unmaintained library will not receive patches for future vulnerabilities. The passlib[bcrypt] extra also pins an old bcrypt (3.x) while 5.0.0 is current.",
    "task": "Evaluate migrating password hashing to argon2-cffi (argon2id) or pwdlib. If staying with passlib, at minimum pin bcrypt>=4.0.0 directly and monitor for CVE advisories.",
    "auto_fixable": false,
    "effort": "medium",
    "package": "passlib",
    "current_version": "1.7.4",
    "latest_version": "1.7.4"
  },
  {
    "id": "deps-4",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "cryptography 42.0.8 is 4 major versions behind current (46.0.5). Versions 43.x through 46.x contain security patches including fixes for certificate validation and memory safety issues. The system Python also has 3.4.8 installed, suggesting version divergence.",
    "task": "Upgrade cryptography to >=46.0.0 in pyproject.toml. Run tests after upgrade as some APIs may have changed.",
    "auto_fixable": true,
    "effort": "small",
    "package": "cryptography",
    "current_version": "42.0.8",
    "latest_version": "46.0.5"
  },
  {
    "id": "deps-5",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "Three OpenTelemetry instrumentation packages are pinned to a beta version (0.47b0): opentelemetry-instrumentation-fastapi, opentelemetry-instrumentation-sqlalchemy, opentelemetry-instrumentation-celery. Beta packages in production observability infrastructure may silently drop spans or behave unexpectedly, and no security advisories are tracked for pre-release versions.",
    "task": "Upgrade opentelemetry-instrumentation-* packages to stable release (0.50b0 or latest). Check OTel changelog for breaking changes in instrumentation API.",
    "auto_fixable": true,
    "effort": "small",
    "package": "opentelemetry-instrumentation-fastapi",
    "current_version": "0.47b0",
    "latest_version": "0.50b0"
  },
  {
    "id": "deps-6",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "httpx 0.27.0 is behind 0.28.x which includes security hardening around redirect handling and SSL certificate verification defaults. httpx is used for webhook delivery (the existing SSRF vector) â€” an outdated HTTP client compounds that risk.",
    "task": "Upgrade httpx to >=0.28.0 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "httpx",
    "current_version": "0.27.0",
    "latest_version": "0.28.1"
  },
  {
    "id": "deps-7",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "boto3 is pinned with a caret constraint (^1.42.43) which allows minor/patch upgrades but the AWS SDK frequently releases security-relevant patches. No pinning to a specific patch means the resolved version depends on when poetry.lock was last updated.",
    "task": "Run 'poetry update boto3' to pull latest patch and commit the updated poetry.lock. Consider switching to an exact pin or tighter constraint.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "boto3",
    "current_version": "^1.42.43",
    "latest_version": "1.37.x"
  },
  {
    "id": "deps-8",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "pydantic 2.7.4 and pydantic_core 2.41.5 are behind current releases. pydantic 2.10+ includes validation fixes and performance improvements. pydantic_core 2.42.0 is available.",
    "task": "Upgrade pydantic to >=2.10.0 in pyproject.toml and run 'poetry update pydantic pydantic-core'.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "pydantic",
    "current_version": "2.7.4",
    "latest_version": "2.11.0"
  },
  {
    "id": "deps-9",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "issue": "python-dotenv is specified as 1.0.1 in pyproject.toml but the system Python has 0.19.2 installed, suggesting version drift between system and project virtual environment. The pip list shows 1.2.1 is latest.",
    "task": "Update python-dotenv to >=1.2.1 in pyproject.toml to pick up latest fixes.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "python-dotenv",
    "current_version": "1.0.1",
    "latest_version": "1.2.1"
  }
]
